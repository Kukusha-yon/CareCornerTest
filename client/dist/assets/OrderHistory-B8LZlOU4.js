import{j as e,r as P,R as $,s as u,S as B,F as z,k as H,o as v,X as w,t as U,p as V,C as Y}from"./ui-B5PjYYeE.js";import{u as K,b as M,r as l}from"./vendor-qOmVjXE-.js";import{e as Q,b as W,u as X,V as t}from"./index-DBuhCPqP.js";import{B as r}from"./Button-BWQtias1.js";import{d as C,g as G}from"./orderService-DscCu6l1.js";const le=()=>{const o=K(),p=M(),{user:J}=Q(),{addToCart:S}=W(),[k,c]=l.useState(!1),[g,n]=l.useState(null),[Z,O]=l.useState(!1),[i,A]=l.useState(""),[d,T]=l.useState("all"),{data:x=[],isLoading:F,error:f,refetch:m}=X({queryKey:["userOrders"],queryFn:G,staleTime:0,refetchOnMount:!0});l.useEffect(()=>{var s;((s=p.state)==null?void 0:s.from)==="order-confirmation"&&(t.success("Your order has been placed successfully!"),O(!0))},[p]);const L=async s=>{try{await C(s),t.success("Order cleared successfully"),n(null),m()}catch(a){console.error("Error clearing order:",a),t.error("Failed to clear order")}},D=async()=>{try{await Promise.all(x.map(s=>C(s._id))),t.success("All orders cleared successfully"),c(!1),m()}catch(s){console.error("Error clearing all orders:",s),t.error("Failed to clear all orders")}},_=s=>{switch(s.toLowerCase()){case"delivered":return e.jsx(Y,{className:"w-5 h-5 text-green-500"});case"shipped":return e.jsx(V,{className:"w-5 h-5 text-blue-500"});case"pending":return e.jsx(U,{className:"w-5 h-5 text-yellow-500"});default:return e.jsx(u,{className:"w-5 h-5 text-gray-500"})}},E=s=>{switch(s.toLowerCase()){case"delivered":return"text-green-700 bg-green-50";case"shipped":return"text-blue-700 bg-blue-50";case"pending":return"text-yellow-700 bg-yellow-50";default:return"text-gray-700 bg-gray-50"}},q=s=>{try{s.items.forEach(a=>{S({_id:a._id,name:a.name,price:a.price,image:a.image,countInStock:a.countInStock},a.quantity)}),t.success("Items added to cart"),o("/cart")}catch(a){console.error("Error adding items to cart:",a),t.error("Failed to add items to cart")}},I=s=>{o("/support",{state:{orderId:s._id}})},R=x.filter(s=>{var j,y,N,b;const a=s._id.toLowerCase().includes(i.toLowerCase())||((y=(j=s.shippingDetails)==null?void 0:j.fullName)==null?void 0:y.toLowerCase().includes(i.toLowerCase()))||((b=(N=s.shippingDetails)==null?void 0:N.email)==null?void 0:b.toLowerCase().includes(i.toLowerCase())),h=d==="all"||s.status===d;return a&&h});return F?e.jsx("div",{className:"min-h-screen bg-gray-50 pt-24",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#39b54a]"})})})}):f?e.jsx("div",{className:"min-h-screen bg-gray-50 pt-24",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"Unable to load orders"}),e.jsx("p",{className:"text-gray-500 mb-4",children:f.message}),e.jsxs(r,{variant:"primary",onClick:m,className:"bg-[#39b54a] hover:bg-[#2d8f3a] text-white",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})})}):x.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 pt-24",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(u,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"No orders yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"When you place an order, it will appear here."}),e.jsx(r,{variant:"primary",onClick:()=>o("/products"),className:"bg-[#39b54a] hover:bg-[#2d8f3a] text-white",children:"Start Shopping"})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 pt-24",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Your Orders"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"Search orders...",value:i,onChange:s=>A(s.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#39b54a] focus:border-transparent"})]}),e.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[e.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsxs("select",{value:d,onChange:s=>T(s.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#39b54a] focus:border-transparent appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsx(H,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5 pointer-events-none"})]}),e.jsxs(r,{variant:"outline",onClick:()=>c(!0),className:"text-red-600 hover:text-red-700 border-red-600 hover:border-red-700",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Clear All"]})]})]}),e.jsx("div",{className:"space-y-6",children:R.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300",children:[e.jsx("div",{className:"border-b border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-sm font-medium ${E(s.status)}`,children:[_(s.status),e.jsx("span",{className:"ml-1",children:s.status})]}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:["#",s._id.slice(-8)]}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["$",s.totalAmount.toFixed(2)]})]}),e.jsx(r,{variant:"outline",onClick:()=>n(s),className:"text-red-600 hover:text-red-700 border-red-600 hover:border-red-700 p-1",children:e.jsx(v,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-2",children:s.items.map((a,h)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gray-100 rounded-md overflow-hidden",children:a.image?e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.name}),e.jsxs("p",{className:"text-sm font-medium text-gray-900 ml-2",children:["$",(a.quantity*a.price).toFixed(2)]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.quantity," Ã— $",a.price.toFixed(2)]})]})]},h))}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200 flex flex-wrap gap-2",children:[e.jsx(r,{variant:"outline",onClick:()=>q(s),className:"flex-1 sm:flex-none text-sm py-1",children:"Reorder"}),e.jsx(r,{variant:"outline",onClick:()=>I(s),className:"flex-1 sm:flex-none text-sm py-1",children:"Contact Support"})]})]})]},s._id))})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Clear All Orders"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx(w,{className:"h-6 w-6"})})]}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Are you sure you want to clear all your orders? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(r,{variant:"outline",onClick:()=>c(!1),className:"text-gray-700 border-gray-300 hover:bg-gray-50",children:"Cancel"}),e.jsx(r,{variant:"primary",onClick:D,className:"bg-red-600 hover:bg-red-700 text-white",children:"Clear All"})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Delete Order"}),e.jsx("button",{onClick:()=>n(null),className:"text-gray-400 hover:text-gray-500",children:e.jsx(w,{className:"h-6 w-6"})})]}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Are you sure you want to delete this order? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(r,{variant:"outline",onClick:()=>n(null),className:"text-gray-700 border-gray-300 hover:bg-gray-50",children:"Cancel"}),e.jsx(r,{variant:"primary",onClick:()=>L(g._id),className:"bg-red-600 hover:bg-red-700 text-white",children:"Delete"})]})]})})]})};export{le as default};
